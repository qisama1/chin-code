# 项目配置搭建

项目配置搭建，持续更新
## 1. hertz

根据文档搭建即可，https://github.com/cloudwego/hertz/blob/develop/README_cn.md

### hz工具的使用
#### 创建
```golang
# 不在`$GOPATH`下的项目通过工具提供的`-module`命令指定一个自定义 module 名称即可：
hz new -module example.com/m -idl idl/hello.thrift

# 整理 & 拉取依赖
go mod tidy

# 查看 go.mod 中 github.com/apache/thrift 版本是否为 v0.13.0，如果不是则继续执行 2.2 小节剩余代码
go mod edit -replace github.com/apache/thrift=github.com/apache/thrift@v0.13.0

# 整理 & 拉取依赖
go mod tidy

```

#### 更新
hz update -idl idl/draw.thrift

## 2. gorm, gorm-gen
根据文档搭建即可，https://www.liwenzhou.com/posts/Go/gen/

## 3. 集成hlog

```golang
# 获取扩展的zap（实现了hlog接口
go get github.com/hertz-contrib/logger/zap


// Code generated by hertz generator.

package main

import (
	"github.com/cloudwego/hertz/pkg/app/server"
	"github.com/cloudwego/hertz/pkg/common/hlog"
	hertzzap "github.com/hertz-contrib/logger/zap"
	_ "hertz-lottery/biz/dal"
)

func main() {
	h := server.Default()
	logger := hertzzap.NewLogger()
	hlog.SetLogger(logger)
	register(h)
	h.Spin()
}


```
## 4. redis
使用的是redis/v7
```golang
package redis

import (
	"fmt"
	"github.com/go-redis/redis/v7"
	"time"
)

const (
	Addr     = "127.0.0.1:6379"
	Password = "123456"

	ActivityCountCachePrefix = "activity_count_cache_prefix_%s"
)

var (
	expireTime = time.Hour * 1
	Redis      *redis.Client
)

func init() {
	Redis = redis.NewClient(&redis.Options{
		Addr:     Addr,
		Password: Password,
		DB:       0,
	})
}

func BuildKey(prefix string, key string) string {
	return fmt.Sprintf(prefix, key)
}

```

## 5. kafka, zk
1. docker搭建kafka环境
2. 用go-kafka去接入
3. 创建topic的命令
```shell
./kafka-topics.sh --create --topic topic-lottery-deduce-stock --bootstrap-server local
host:9092
```

