# kafka保证消息幂等
1. 业务给一个唯一key，下游消费的时候针对key给一个分布式锁，最后通过数据库表设置唯一键来保证消息的幂等
2. 发送消息的时候创建了一个全局的id，下游消费的时候判断全局id是否存在，如果存在，这条消息就不用处理
3. 如果有状态流转的业务，如果此时状态机已经处于下一个状态，这时候上一个状态的消息，这时候就不用处理。
4. 对于更新的业务，可以采取基于版本号的乐观锁，更新SQL的时候加入版本号的判断。