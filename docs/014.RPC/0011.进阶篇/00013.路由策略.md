# 路由策略

回想起我之前做过项目中就有一个路由选择组件，路由就可以理解为，某个请求应该打到哪个服务上。

在数据库方面的路由就是对于特定ID的数据要放到哪个数据库表中。在RPC请求中就是，哪个IP的哪个数据，应该打到哪个服务提供节点上。

## 背景
灰度发布，当我们新发布的服务需要进行灰度发布让一小部分的服务调度者先去使用一下，如果合适的话再加大发布力度。

## IP路由
IP路由就是让指定IP的服务调度者才能使用我们新发布的服务
## 参数路由
IP路由有个缺点就是，如果我想让指定的参数（如商品服务的商品），这样细粒度的路由使用。就得要一定的参数策略。

比如像路由选择组件中使用的就是哈希的办法，配合上threadlocal去设置当前请求要使用的库表。

在使用dubbo的时候，例如支付服务，有各个银行的服务提供节点，那么给这些银行的服务提供节点一个特定的ID同时设置在dubbo group上，在调用之前有一层路由策略层，路由策略层会根据请求不同的银行（参数），根据dubbo提供的api导向到不同的dubbo group。