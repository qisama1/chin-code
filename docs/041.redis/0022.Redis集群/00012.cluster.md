# cluster集群
高并发的场景下，普通的主从复制可能解决不了的情况下，就需要有更好的能处理高并发的架构，cluster集群

## 为什么需要redis集群

1. redis缓存的数据太多
2. 并发量太大

redis集群其实就的对redis进行切片，将redis用哈希算法分成不同的区，一个区是一个redis小主从复制集群。

## 为什么哈希槽是16384个
使用的CRC16算法的问题，可以产生2^16,65536个数出来。

但是由于内存考虑以及设计上认为这么多已经足够了。

## 如何进行扩容和收容
扩容：增加一组或几组主从节点

1. 准备新节点
2. 将新节点加入集群
3. 迁移槽和数据

## 扩容缩容的时候可以提供服务吗
可以。

1. 如果发送的key没有发生迁移，就返回结果
2. 如果正在发生迁移，就要进行重定向，被发送-ASK重定向错误。
3. 再次再查询就会先发送ASKING命令。
4. 如果已经完成了迁移，就会返回-MOVED重定向，导向新的节点。

## 该选谁做新的master
sliver发现master挂了以后会向其他master发送请求信息，如果超过半数其他master同意了，就会成为新的master

## 如何实现高可用
也是有一主多从，主节点负责读写，从节点只负责备份不负责请求。
