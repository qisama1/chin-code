# 混合持久化

由于RDB和AOF各有优缺点，RDB4.0版本的时候开启了一个混合持久化的方式。但是它默认的关闭的。

## RDB对比AOF

### RDB的优势
1. 二进制压缩文件，其占用空间小
2. RDB容易恢复，直接解压出来即可，而AOF需要一条条地去执行

### AOF的优势
1. 结果易懂
2. 安全性高，不容易丢失数据。

## 混合持久化

aof-use-rdb-preamble yes.

变更就是在重写的时候不仅是改变命令了，而是将重写时刻之前的内存都做成RDB快照。所以新的文件是由RDB和AOF两部分组成，重启的时候先加载RDB快照，再增量的执行AOF部分。

其实混合持久化就是AOF，但是他是加强版的AOF。