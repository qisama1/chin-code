# 堆
Java堆是虚拟机管理的内存中最大的一块，并且被所有线程共享。

## 几乎所有实例都在Java堆中
所有的对象实例和数组理应在Java堆中分配。但是现在发展过程中，现在有迹象表明可能会出现值类型的支持。栈上分配和标量替换使得这个问题不那么肯定了（逃逸分析后，如果一个对象是不会影响其他地方，那么就会发生栈上分配，同时不会生成这个对象，而是标量替换成多个变量）。

话术：新创建的对象都在Java堆中。如果提到例外就是栈上分配和标量替换。

## 新生代和老年代
Java堆目前被分成了新生代和老年代。
新生代被分为Eden和Survivor两个区域，而Survivor也有S0和S1区，并且三者按8:1:1分配。

Eden = 8 / 10, S1 = S2 = 1 / 10;

JVM每次只会使用一块Eden和一块Survivor，也就是一定有一块S会被空出。这里在垃圾回收详写。