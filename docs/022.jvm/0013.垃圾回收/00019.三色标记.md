# 三色标记

## 白色对象
对象没有被垃圾回收器访问过（在最开始的时候，所有的对象都是白色对象，如果在最后还是白色对象，说明他要被回收了
## 黑色对象
黑色对象已经被垃圾回收器访问过了，并且这个对象所有的引用都已经扫描过了，黑色对象代表已经扫描过的，它是安全存活的。
## 灰色对象
灰色对象代表被垃圾回收器访问过，但是有一部分引用还没有被扫描过。

## 误判
整个三色标记的过程就是从白色-》灰色-》黑色的推进过程。但是其中如果出现这种情况：

1. 插入一条黑色对象到白色对象的引用
2. 删除灰色对象到白色对象的引用

那么会导致一个误判，把需要的对象给回收了。

## 解决方案

### 增量更新
当黑色对象增加了这个引用后，要把这一行为记录下来，之后再次进行扫描。

可以理解为把黑色对象变为灰色对象，破坏了第一个条件
### 原始快照
当灰色对象删除了这个引用，也要把这个行为记录下来，在最后重新扫描一遍，可以理解为忽视这个删除，按最初的对象快照图来进行搜索。

### 使用情况
CMS是基于增量更新来做并发的。

G1是用原始快照来实现。